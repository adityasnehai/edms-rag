# ADR-001: Kafka Partitioning Strategy for Workflow Events

## context
The workflow execution engine relies on Kafka topics to propagate state transitions between services.
Over the last two quarters, customer onboarding increased by ~40%, resulting in higher event throughput.
Existing topics were created with 6 partitions, which caused uneven consumer utilization and sustained lag
during peak business hours in US-East.

## considered_options
1. Keep current partition count  
   Pros: No operational change  
   Cons: Consumer lag, SLA risk  

2. Increase partitions without keying  
   Pros: Higher throughput  
   Cons: Breaks ordering guarantees  

3. Increase partitions with tenant-based keys  
   Pros: Preserves ordering per tenant, scales horizontally  
   Cons: Risk of hot tenants  

## decision
Increase partition count to 24 and enforce tenant_id as the partition key.

## rationale
Tenant-level ordering is a business requirement, and most high-volume workflows are tenant-scoped.
This approach balances scalability and correctness without introducing new infrastructure.

## consequences
Improved throughput for most tenants.
Large tenants may still cause hot partitions, which later contributed to consumer lag (INC-001).
